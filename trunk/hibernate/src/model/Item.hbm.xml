<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping package="model">
    <class name="Item" table="item" batch-size="5">
    	 <meta attribute="class-code">
    	 	public void addBid(Bid bid){
				bid.setItem(this);
				this.bids.add(bid);
			}    	 	
    	 </meta>
    	 <cache usage="read-write"/>
        <id name="itemId" type="java.lang.Long">
        	<meta attribute="use-in-tostring">true</meta>
            <column name="ITEM_ID" />
            <generator class="identity" />
        </id>
        <many-to-one name="seller" class="Users" column="SELLER_ID"/>
        <many-to-one name="approvedBy" class="Users" column="APPROVED_BY_USER_ID"/>
        <property name="objVersion" type="java.lang.Integer">
            <column name="OBJ_VERSION" />
        </property>
        <property name="itemName" type="java.lang.String">
        	<meta attribute="use-in-tostring">true</meta>
            <column name="ITEM_NAME" not-null="true" />
        </property>
        <property name="description" type="java.lang.String">
            <column name="DESCRIPTION" length="65535" />
        </property>
        <property name="initialPrice" type="java.lang.Double">
            <column name="INITIAL_PRICE" />
        </property>
        <property name="initialPriceCurrency" type="java.lang.String">
            <column name="INITIAL_PRICE_CURRENCY" length="3" />
        </property>
        <property name="reservePrice" type="java.lang.Double">
            <column name="RESERVE_PRICE" />
        </property>
        <property name="reservePriceCurrency" type="java.lang.String">
            <column name="RESERVE_PRICE_CURRENCY" length="3" />
        </property>
        <property name="startDate" type="java.sql.Timestamp">
            <column name="START_DATE" length="0" />
        </property>
        <property name="endDate" type="java.sql.Timestamp">
            <column name="END_DATE" length="0" />
        </property>
        <property name="itemState" type="java.lang.String">
            <column name="ITEM_STATE" />
        </property>
        <property name="approvalDatetime" type="java.sql.Timestamp">
            <column name="APPROVAL_DATETIME" length="0" />
        </property>
        <property name="created" type="java.sql.Timestamp">
            <column name="CREATED" length="0" />
        </property>
        <!--
        <set name="bids" inverse="true" cascade="save-update" lazy="false">
            <key>
                <column name="ITEM_ID" />
            </key>
            <one-to-many class="Bid" />
        </set>
        -->
        <!--
        <bag name="bids" inverse="true" cascade="save-update" lazy="false">
            <key>
                <column name="ITEM_ID" />
            </key>
            <one-to-many class="Bid" />
        </bag>
        -->
	    <set name="categorizedItems" inverse="true">
	        <key column="CATEGORY_ID"/>
	        <one-to-many class="CategorizedItem"/>
	    </set>        
        <list name="bids" cascade="save-update, delete, delete-orphan" >
<!--         	<cache usage="read-only"/> -->
        	<key column="ITEM_ID"/>
        	<list-index column="BID_POSITION"/>
        	<one-to-many class="Bid"/>
        </list>
        <idbag name="images" table="ITEM_IMAGES">
	        <collection-id type="java.lang.Long" column="ITEM_IMAGE_ID">
	        	<generator class="increment"></generator>
	        </collection-id>
            <key>
                <column name="ITEM_ID" not-null="true" />
            </key>
            <element column="FILENAME" not-null="true" type="java.lang.String"/>
        </idbag>
		<bag name="categories" table="CATEGORY_ITEM" inverse="true" cascade="save-update">
        	<key column="ITEM_ID"/>
        	<many-to-many class="Category" column="CATEGORY_ID"/>
        </bag>        
        <join table="ITEM_BUYER" optional="true" inverse="true">
        	<key column="ITEM_ID" unique="true" not-null="true" />
        	<many-to-one name="buyer" column="USER_ID"/>     
        </join>
    </class>
</hibernate-mapping>
