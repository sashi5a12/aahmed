<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:activiti="http://www.activiti.org/schema/spring/components"
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd 
http://www.activiti.org/schema/spring/components http://www.activiti.org/schema/spring/components/activiti.xsd">

    <bean id="companyApprovalHandler" class="com.netpace.device.handler.WorkflowEventHandler" />

    <bean id="processEngineConfiguration" class="org.activiti.spring.SpringProcessEngineConfiguration">
    <property name="dataSource" value="#{T(net.bull.javamelody.JdbcWrapper).SINGLETON.createDataSourceProxy(dataSource)}" />
    <property name="transactionManager" ref="transactionManager" />
    <property name="databaseSchemaUpdate" value="true" />
<!--    <property name="mailServerHost" value="localhost" />
    <property name="mailServerPort" value="5025" />-->
    <property name="jpaEntityManagerFactory" ref="entityManagerFactory" />
    <property name="jpaHandleTransaction" value="false" />
    <property name="jpaCloseEntityManager" value="false" />
    <property name="jobExecutorActivate" value="false" />
    <property name="deploymentResources" value="classpath*:*ApprovalWorkflow.bpmn20.xml" />
  </bean>
  
  <bean id="processEngine" class="org.activiti.spring.ProcessEngineFactoryBean">
    <property name="processEngineConfiguration" ref="processEngineConfiguration" />
  </bean>
  
  <bean id="activitiRule" class="org.activiti.engine.test.ActivitiRule">
    <property name="processEngine" ref="processEngine" />
  </bean>
  
  <bean id="repositoryService" factory-bean="processEngine" factory-method="getRepositoryService" />
  <bean id="runtimeService" factory-bean="processEngine" factory-method="getRuntimeService" />
  <bean id="taskService" factory-bean="processEngine" factory-method="getTaskService" />
  <bean id="historyService" factory-bean="processEngine" factory-method="getHistoryService" />
  <bean id="managementService" factory-bean="processEngine" factory-method="getManagementService" />

<!--    init-method="enableDuplicateFiltering"-->
  <bean id="deploymentBuilder" factory-bean="repositoryService" 
        factory-method="createDeployment" init-method="enableDuplicateFiltering"/>
  
  <bean id="deploy" factory-bean="deploymentBuilder" factory-method="deploy" />
  
<!--  <bean id="deployBean" factory-bean="deploymentBuilder" factory-method="deploy" />-->

</beans>